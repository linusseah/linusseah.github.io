---
layout: post
title: "Inside Out: Machine Learning & Lexical Rule Based Emotion Classifier for Textual Input"
date: 2020-01-20
excerpt: "Capstone project for General Assembly - Data Science Immersive 11 (Oct 29 2019 - Jan 31 2020). Machine Learning & Lexical Rule Based Emotion Classifier for Text"
project: true
tags: [nlp, recommender system, web scraping, logistic regresion, decision trees, flask]
comments: true
---
# Background  
> For most of us, experiencing, intepreting, understanding and reacting to our own emotional states and those around us are very much a part of our daily interactions at the workplace, at home with our parents and so on; reacting appropriately to different situations based on the emotional context is key to personal / business etc success - i suspect this is why friends often prefer meeting up in person / business executives insist on having face to face negotiations. However our appreciation of the emotional context is often done in-person - we read emotions based on tonality, body-language, facial expressions and so on. For this reason, emotional interpretation is largely limited to a localised / small settings; but what if we could do the same 'en-masse' using other less conventional pieces of information like the way / the content of a piece of textual input? What if we could tell how a hundred, or a thousand people are feeling at a particular point in time and specifically about what -- in real time no less. These questions motivated the research and development of a tool that could efficiently provide 'emotional data' en-masse starting with text as input.  

# Summarised problem statement
It is difficult to gather emotional feedback at scale. A potential way to do so is to mine and interpret readily available but hard to interpret unstructured forms of input (like text on social media). 

# Proposed solution 
Using primarily textual input to make a real-time predicion of emotions based on Natural language processing and classification modelling.  

The following are some examples of potential use cases for 'emotional-listening': 

1. Lack of explicit emotional input for digital recommendations: 

Recommendations are often made in the absence of emotional considerations, which could lead to poor targeting 


2. Costly and time-consuming to gather mass implicit feedback: 

Information on the emotional response to an event (could be a press release, a public speech etc) could be helpful for better decision making (e.g. reactions toward a certain action of policy) but obtaining this implicit feedback in real-time and on a mass level is often costly and time-consuming, if even possible. While explicit emotional feedback can be gained through social media platforms like facebook it would be more powerful if we could get that same analysis implicitly based on individual's textual input on publicly accessible platforms. 


3. Preventative action: 

Unfortunate events like mass-killings are often preceded by telling messages indicative of troubled emotions before the incidents happen but are usually only discovered only post-mortem.    


4. Augmented sentiment analysis: 

Current sentiment analysis is usually binary. However, even within the broad categories of ‘good’ or ‘bad’ it would be helpful to understand what kind of ‘good’ or ‘bad’ in order to respond more appropriately 


5. Facilitating better human interaction:

Different people are wired differently and communicate in ways that might get easily misconstrued, leading to relationship breakdowns. This model hopes to smoothen some of those kinks by adding an additional layer of perspective on how someone might be feeling or why they might be writing that way (e.g. personality type) so that individuals can better understand each other.


6. Difficulty in interpreting specifically short, informal / social-media based / localised textual input:

There are quite a few existing ML models and rule-based NLP libraries out there that perform well on more formal textual structures (academic writing etc where traditional semantics are adhered to) However, informal/unstructured textual input often deviates from these semantic norms and often include other lexical structures that are dynamic and localised in nature - causing said ML models / rule based systems to perform poorly on them. Given that a large proportion of (textual)data that reveal real-time information is unstructured, there should be more emphasis on developing a model/rule-based system that specialises in 'understanding' unstructured data. 


# Methods applied 
    
1. Natural Language Processing: to parse through text and convert it into a meaningful format / scoring system for the machine to train on 


2. Classification modelling: train the model against the tagged emotional state to accurately classify emotions according to textual input 

Stretch output:
- maybe recommendation systems (KIV. Stretch output)

- maybe time series analysis (to figure out whether there is any seasonality or trends with emotions - but this requires a time-stamp on textual input)


# Deliverables / milestones 

- low level: a model that predicts emotions based on textual input (key in something as input argument, and it returns an emotional state) 

- lower level+: local deployed app (using flask) without any decorations (takes in text input, predicts emotion) 

- lower level+2: above and with spider graph representation of emotions (e.g. 2.0 anger, 3.0 sad, 1.0 happiness etc) 

- mid-level: as above but fully deployed web-app that takes text input and provides an emotional state as output (using flask + heroku) 

- mid-level+: as above, with HTML decoration (maybe Inside-out themed) 

- high-level: do as with emotions, for MBTI prediction using the kaggle MBTI dataset. Use both MBTI + emotional state predictions to generate some kind of recommendation on how to best understand the individual 

- high-level: additional visualisation of a singapore ‘emotional heat map’ based on either static or live text/other input + location? 

- high-level+: could be packaged in the form of a widget? I dno or some kind of embedded back end technology that feeds emotion as info to the end user (however they choose to use it - e.g. in a music recommendation system, reommendations could be augmented by accounting for specific emotions of the end-user)

- Bonus: train against both emotion and personality (reason being - the same textual output from 2 ppl of differing personalities could be interpreted as stemming from different emotional states) 

- define own specific list of 'identifers' for each emotional class type (i.e. let the NLP do the tagging instead of relying on pre-classified tags) not sure how but maybe can use VADER (or some other rule based system) to provide the valences of each sentence then use an unsupervised learning based machine learning technique to form clusters based on the valence data (each emotion type could have a particular valence score). Based on clusters formed, can start making sense of it to determine whether it corresponds with a particular emotion - but as Vader/Hutto themselves concluded in thier paper, ML approach is difficult due to the lack of comprehensive training sets and secondly, transparency of how the models have processed the data. 

- Building out a localised VADER equivalent package for interpreting Singlish 

# (Commercial) use cases 
    
1. Emotional analysis used to do targeted marketing

2. Better recommendations (think Spotify songs that are mood appropriate) 

3. Used to pre-empt bad events from happening (think pre-empting watch-dogs when suicidal messages are detected) 

4. Used for more granular sentiment analysis (for policy makers, anything… that find an emotional response informative): (stretch goal: input a query e.g. US elections. backend scraper will scrape form chosen medium e.g. twitter for all US election based tweets, clean it up and run multiple tweets through the model and produce a emotion % score e.g. 40% happy, 20% angry, 20% fear, 20% neutral etc) so this pivots from analyzing a single text input to multiple text inputs at once 

5. Mental health tracker: ppl can journal and put their journal through this analyser, which will help to track their emotions at chosen time intervals over time 

6. To help with disabilities: if a speech to text function can pass info through this model to return feedback on emotions, it can help those with an impaired ability to pick up emotional nuances through daily text/speech based interactions.

7. Smoothen interactions / build community at workplaces: foster better understanding and empathy btw individuals of different personalities types who may have different ways of interacting and working. A practical application could be say, an end user running an email through the classifier to retrieve some info on the emotional state and perosnality type of the sender (many atimes terse sonuding emails could be construed as unfriendliness but if sender is a INTJ or someth then receiver can better understand that perhaps that is just the way INTJ's tend to interact)  

8. In general, as an additional data point — layered on top of other structured and unstructured data inputs (ppl posting live videos on facebook, insta-stories etc) 


# To consider 

- how to best score emotions? What kind of scale? Maybe some kind of happiness index ?  (Need to find some kind of objective and standardised way to score text input and map that against an emotional scale) 

- how many emotions do I want to classify? 

- how would I delineate one emotion from another? (Should they exist along some kind of spectrum?) 

- how do I deal with complex emotion? (Ppl can experience multiple emotions at once) -> would be nice to map it onto a spider graph and show how much of each emotion is being expressed through that textual input 

- would it make sense to couple this study with prediction of personality (could be the case that given someone’s personality, the same textual input could be interpreted differently ) 

- what other features are relevant for this study? (e.g. keep layering study with other data inputs like bio-chemical info, maybe current activity or diet?) 

 >can look at Heidi’s NLP bits + her scoring functions to understand how she picked up comments effectively and scored every textual input based on different elements 

> if current classification tags are not consistent, might want to tag them myself based on my own scoring system? (but need to find own list of 'emotion' based stock words that i can use to classify something into an emotion 

> if certain datasets have more emotion classifications than others, thinking that it would be more feasible to 'scale-down' the emotional spectrum rather than up. i.e. classifying more granular emotional classifications under their broader categories 


# Data 

- Kaggle dataset for emotions 

- Kaggle dataset for personality

- twitter tweets (to use as test set? - need to apply for api) 

- kaggle dataset for MBTI personality prediction 

- (stretch: Facebook posts using fb graph api) 

- (stretch: find some way to get 'live' textual input with geo-location so that we can 'map' out emotions)


# Other anticipated difficulties
    
1. Text as a pure emotion analyser would be difficult as there is so much that is lost when we exclude the verbal intonations, facial expressions etc so can think about how you can compensate for those things in your analysis (e.g. picking up bold, or italics, exclamations, or emojis etc) could also consider how I can maybe augment the dataset with other features to better predict for emotion? 


2. a single textual input could referce multiple emotional states at varying points in time e.g. someone recouting his or her emotions throughout the day. How to reconcile this? the overall emotional state on balance? 


3. things like sarcasm, or passive-aggressiveness would be hard to detect and even so, to classify as a particular emotion


4. pejoratives (words expressed as neutral or even positive statements to mask a negative sentiment) e.g. 'the chicken had a unique taste... or his idea was interesting..." 


5. picking up emotional-nuances expressed in non-textual cues like emoticons or accents like bold, italics etc e.g. ... or :>, **angry** etc 


6. slang is localised. so the model would probably not perform well in different cultural contexts unless it is trained on multiple localised datasets (e.g. American slang used to connote certain emotions are not the same as those that Singaporeans would use) slang is also dynamic in nature (this is why things like urban dictionary exist because new words are always getting added to it) this also means that the model will have to be continuously trained on new datasets/ add new words to an emotion library 


7. lexical methods are context specific; vocab that connotes specific emotion differ from setting to setting. (e.g. lexical anaylsis for social media would be alot more slang/emoticon heavy whereas the same for formal writing would not) So a model trained on a social media based dataset would probably not do as well when interpreting the emotions of formal prose. 


8. humans experience complex emotions (it's hard enough for a human to accurately interpret emotion, not to mention computers...) so it would be important to objectively quantify that complex expression in some way. Also to figure out which emotions are compatible with each other and which aren't. (e.g. you can be both happy and excited at the same time... but happy and angry? ... possible?) "locating your current emotional state in a N-dimensional emotional plane - plotted over time would form your emotional cloud "
note to self: i think this can be captured in the theory of valence - which classifies emotions into generally positive or negative sentiments
https://en.wikipedia.org/wiki/Valence_(psychology)


9. dealing with imbalanced classes of emotions (general emotions like joy or sadness would be classified far more often than more nuanced ones like emptiness..) more broadly speaking, the process of classifying emotions is tricky because sometimes we don't even know how to particularize our emotions in words.  


10. dataset is currently being trained largely on individual sentences. Not sure how well the model would perform on larger chunks of texs e.g. paragraphs - **find some way to split the analysis up to the sentence? e.g. within paragraphs**  


11. will cleaning technique differ depending on subsequent method of analysis adopted? (e.g. if VADER uses emoticons and Caps to detect valence then we probably shouldnt strip the text of non-textual input and lowercase everything)




